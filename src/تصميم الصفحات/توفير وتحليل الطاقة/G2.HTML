<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>توبشيلد - تحليل توفير الطاقة المتقدم</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #2c3e50); /* #1a2a6c, #b21f1f, #fdbb2d */
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 20px; /* Increased padding */
            margin-bottom: 40px; /* Increased margin */
            background: rgba(0, 0, 0, 0.35); /* Slightly darker for more contrast */
            border-radius: 20px; /* Softer radius */
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        header h1 {
            font-size: 3rem; /* Slightly larger */
            margin-bottom: 15px;
            background: linear-gradient(to right, #56ab2f, #a8e063); /* Green gradient for savings/eco */
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 3px 6px rgba(0, 0, 0, 0.25);
        }
        
        header p.subtitle { /* New class for subtitle */
            font-size: 1.3rem; /* Slightly larger */
            opacity: 0.9;
            max-width: 900px;
            margin: 0 auto;
            color: #e8e8ff; /* Lighter for better readability */
            line-height: 1.6;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(480px, 1fr)); /* Adjusted minmax */
            gap: 30px; /* Increased gap */
            margin-bottom: 40px;
        }
        
        .card {
            background: rgba(20, 30, 48, 0.9); /* Slightly more opaque */
            border-radius: 20px; /* Softer radius */
            padding: 30px; /* Increased padding */
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.45);
            border: 1px solid rgba(255, 255, 255, 0.15);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .card:hover {
            transform: translateY(-12px); /* More pronounced hover */
            box-shadow: 0 18px 40px rgba(0, 0, 0, 0.55);
        }
        
        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px; /* Increased margin */
            padding-bottom: 20px; /* Increased padding */
            border-bottom: 2px solid rgba(86, 171, 47, 0.6); /* Green accent */
        }
        
        .card-header i {
            font-size: 2.2rem; /* Slightly larger */
            margin-left: 20px; /* Increased margin */
            color: #a8e063; /* Green accent */
        }
        
        .card-header h2 {
            font-size: 2rem; /* Slightly larger */
            color: #a8e063; /* Green accent */
        }
        
        .chart-container {
            flex: 1;
            min-height: 320px; /* Increased min-height */
            position: relative;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            margin-top: 25px;
            gap: 35px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 1.15rem;
        }
        
        .legend-color {
            width: 28px; /* Larger legend color */
            height: 28px;
            border-radius: 50%;
            margin-left: 12px;
            border: 2px solid rgba(255,255,255,0.5); /* Added border */
        }
        
        .comparison {
            display: flex;
            justify-content: space-around;
            margin-top: 25px;
            gap: 15px; /* Added gap for comparison items */
        }
        
        .comparison-item {
            text-align: center;
            flex: 1;
            padding: 20px; /* Increased padding */
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1); /* Brighter background */
        }
        
        .comparison-item h3 {
            font-size: 1.5rem; /* Slightly larger */
            margin-bottom: 18px;
            color: #56ab2f; /* Green accent */
        }
        
        .value {
            font-size: 2.8rem; /* Larger value font */
            font-weight: bold;
            margin: 12px 0;
        }
        
        .topshield-value {
            color: #a8e063; /* Brighter green */
        }
        
        .normal-value {
            color: #ff7b7b; /* Softer red */
        }
        
        .savings {
            color: #a8e063; /* Brighter green */
            font-size: 2rem;
            font-weight: bold;
        }
        
        /* ... (previous CSS for heat-bar, info-grid etc. remains largely the same) ... */

        .heat-bar {
            height: 30px;
            background: linear-gradient(to right, #1e3c72, #2a5298, #3498db, #2ecc71, #f1c40f, #e67e22, #e74c3c);
            border-radius: 15px;
            margin: 25px 0;
            position: relative;
        }
        
        .marker {
            position: absolute;
            top: -35px;
            width: 3px;
            height: 40px;
            background: white;
        }
        
        .marker-label {
            position: absolute;
            top: -65px;
            left: 50%; /* Centered */
            transform: translateX(-50%); /* Centered */
            background: rgba(0, 0, 0, 0.8);
            padding: 6px 12px;
            border-radius: 6px;
            font-weight: bold;
            white-space: nowrap;
            font-size: 0.9rem;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Responsive grid */
            gap: 20px;
            margin-top: 20px;
        }
        
        .info-item {
            background: rgba(255, 255, 255, 0.12);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .info-item i {
            font-size: 2.8rem;
            margin-bottom: 18px;
            color: #a8e063;
        }
        
        .info-item .value { /* Re-styling for info-item value */
            font-size: 2.2rem;
            color: #e8e8ff;
        }
         .info-item .savings { /* Re-styling for info-item savings */
            font-size: 1.8rem;
            color: #a8e063;
        }
        
        .footer-note {
            text-align: center;
            padding: 35px;
            background: rgba(0, 0, 0, 0.35);
            border-radius: 20px;
            margin-top: 40px;
            font-size: 1.3rem;
            color: #b0e0ff; /* Lighter blue */
            border: 1px solid rgba(255, 255, 255, 0.15);
        }
        
        .footer-note .highlight {
            color: #a8e063; /* Brighter green */
            font-weight: bold;
            font-size: 1.6rem;
        }

        .season-controls {
            display: flex;
            justify-content: center;
            gap: 25px; /* Increased gap */
            margin: 25px 0 35px 0; /* Added bottom margin */
        }
        
        .season-btn {
            background: rgba(86, 171, 47, 0.3); /* Greenish inactive */
            border: 1px solid rgba(86, 171, 47, 0.7);
            color: white;
            padding: 14px 30px; /* Increased padding */
            border-radius: 35px;
            font-size: 1.2rem; /* Slightly larger */
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .season-btn.active {
            background: linear-gradient(to right, #56ab2f, #a8e063);
            box-shadow: 0 0 20px rgba(168, 224, 99, 0.6);
            border-color: #a8e063;
        }
        
        /* Glass Performance Animation */
        .glass-structure {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 30px 0;
            min-height: 300px; /* Ensure space for animation */
        }
        
        .glass-pane {
            width: 180px; /* Slightly wider */
            height: 280px;
            background: linear-gradient(to bottom, rgba(220,230,255,0.7), rgba(180,200,235,0.2));
            border: 4px solid #a0d2ff;
            border-radius: 15px;
            position: relative;
            box-shadow: 0 0 25px rgba(160, 210, 255, 0.6);
            overflow: hidden; /* For radiation animation */
        }
        
        .coating {
            position: absolute;
            width: 100%;
            height: 15px; /* Thinner coating visual */
            background: rgba(86, 171, 47, 0.7); /* Green for TopShield tech */
            box-shadow: 0 0 12px rgba(86, 171, 47, 0.9);
            z-index: 1;
        }
        
        .top-coating { top: 25%; }
        .bottom-coating { bottom: 25%; }
        
        .radiation {
            position: absolute;
            left: -100%; /* Start off-screen */
            width: 10px; /* Thicker ray for visibility */
            height: 10px;
            border-radius: 5px;
            animation-duration: 2.5s;
            animation-timing-function: ease-in-out;
            animation-iteration-count: infinite;
            z-index: 0;
        }

        .radiation-blocked { background: #ff7b7b; /* Red for blocked/heat */ }
        .radiation-transmitted { background: #f1c40f; /* Yellow for visible light */ }
        
        .radiation-1 { top: 15%; animation-name: flyAndReflect; animation-delay: 0s;}
        .radiation-2 { top: 40%; animation-name: flyAndPass; animation-delay: 0.5s;}
        .radiation-3 { top: 65%; animation-name: flyAndReflect; animation-delay: 1s;}

        @keyframes flyAndPass {
            0% { left: -20%; opacity: 0.5; }
            40% { left: 48%; opacity: 1; transform: scale(1); } /* Hit the glass */
            41% { transform: scale(0.8); } /* Slight impact effect */
            100% { left: 120%; opacity: 0; transform: scale(1); } /* Pass through */
        }
        @keyframes flyAndReflect {
            0% { left: -20%; opacity: 0.5; }
            40% { left: 48%; opacity: 1; transform: scale(1); } /* Hit the glass */
            41% { background-color: #ffc0cb; transform: scale(1.1); } /* Change color/size on impact */
            100% { left: -20%; opacity: 0; transform: scale(0.8) rotate(180deg); } /* Reflect back */
        }
        .radiation-label {
            position: absolute;
            font-size: 0.9rem;
            color: white;
            background: rgba(0,0,0,0.6);
            padding: 3px 8px;
            border-radius: 5px;
            white-space: nowrap;
            z-index: 2;
        }

        /* Styles for Calculator */
        .calculator-form label {
            display: block;
            margin-bottom: 8px;
            font-size: 1.1rem;
            color: #c0d0ff;
        }
        .calculator-form input[type="number"],
        .calculator-form select {
            width: 100%;
            padding: 12px;
            margin-bottom: 18px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.3);
            background: rgba(0,0,0,0.2);
            color: #fff;
            font-size: 1.1rem;
        }
        .calculator-form button {
            background: linear-gradient(to right, #56ab2f, #a8e063);
            color: white;
            padding: 14px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: opacity 0.3s ease;
            width: 100%;
        }
        .calculator-form button:hover { opacity: 0.85; }
        .savings-result {
            margin-top: 25px;
            padding: 20px;
            background: rgba(86, 171, 47, 0.15);
            border: 1px solid rgba(86, 171, 47, 0.4);
            border-radius: 10px;
            text-align: center;
        }
        .savings-result h3 { color: #a8e063; font-size: 1.6rem; margin-bottom: 10px;}
        .savings-result p { font-size: 1.4rem; margin-bottom: 8px;}
        .savings-amount { font-weight: bold; font-size: 2rem; color: #fff; }

        /* Testimonials Section */
        .testimonial-card {
            background: rgba(255, 255, 255, 0.08);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #a8e063;
        }
        .testimonial-card p.quote {
            font-style: italic;
            font-size: 1.15rem;
            margin-bottom: 10px;
            line-height: 1.7;
        }
        .testimonial-card p.author {
            text-align: left;
            font-weight: bold;
            color: #c0d0ff;
        }
        .stars i { color: #f1c40f; margin-right: 3px; }

        /* Call to Action Section */
        .cta-section {
            text-align: center;
            padding: 40px 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 20px;
            margin-top: 40px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .cta-section h2 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #a8e063;
        }
        .cta-section p {
            font-size: 1.3rem;
            margin-bottom: 25px;
            color: #e0e0ff;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }
        .cta-button {
            display: inline-block;
            background: linear-gradient(to right, #56ab2f, #a8e063);
            color: #fff !important; /* Ensure text is white */
            padding: 18px 35px;
            border-radius: 35px;
            text-decoration: none;
            font-size: 1.4rem;
            font-weight: bold;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 5px 15px rgba(86, 171, 47, 0.4);
        }
        .cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(86, 171, 47, 0.6);
        }
        
        @media (max-width: 1100px) {
            .dashboard {
                grid-template-columns: 1fr; /* Single column for smaller screens */
            }
            header h1 { font-size: 2.5rem; }
            header p.subtitle { font-size: 1.1rem; }
            .card-header h2 { font-size: 1.7rem; }
            .value { font-size: 2.2rem; }
            .info-grid { grid-template-columns: 1fr; } /* Single column for info items */
        }
        @media (max-width: 600px) {
            .season-controls { flex-direction: column; gap: 15px; }
            .season-btn { width: 100%; }
            .legend { flex-direction: column; align-items: flex-start; gap: 15px; }
            .comparison { flex-direction: column; gap: 15px; }
            .cta-button { font-size: 1.2rem; padding: 15px 30px; }
            .glass-pane { width: 150px; height: 250px; } /* Adjust glass pane for small screens */
            .radiation-label { font-size: 0.8rem; left: 105% !important; }
        }

    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-shield-alt"></i> حوّل منزلك لواحة راحة ووفّر مع نوافذ توبشيلد الذكية!</h1>
            <p class="subtitle">اكتشف كيف تساهم تقنيتنا المتقدمة في خفض فواتير الطاقة بشكل جذري وتحقيق راحة حرارية لا مثيل لها على مدار العام.</p>
        </header>
        
        <div class="season-controls">
            <button class="season-btn active" data-season="summer">وضع الصيف <i class="fas fa-sun"></i></button>
            <button class="season-btn" data-season="winter">وضع الشتاء <i class="fas fa-snowflake"></i></button>
        </div>
        
        <div class="dashboard">
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-chart-line"></i>
                    <h2>استهلاك الطاقة الشهري (كيلوواط/ساعة)</h2>
                </div>
                <div class="chart-container">
                    <canvas id="energyChart"></canvas>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff7b7b;"></div>
                        <span>نوافذ عادية</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #a8e063;"></div>
                        <span>نوافذ توبشيلد</span>
                    </div>
                </div>
                 <div id="annualSavingsText" style="text-align: center; margin-top: 15px; font-size: 1.2rem; color: #a8e063;"></div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-chart-pie"></i>
                    <h2>تأثير توبشيلد على فاتورة الطاقة</h2>
                </div>
                <div class="chart-container">
                    <canvas id="consumptionChart"></canvas>
                    <p style="text-align:center; margin-top:10px; font-size: 0.9rem; opacity: 0.8;">*رسم توضيحي لنسبة التدفئة والتبريد من إجمالي الفاتورة.</p>
                </div>
                <div class="comparison">
                    <div class="comparison-item">
                        <h3>نوافذ عادية</h3>
                        <div class="value normal-value" id="normalWindowSlice">54%</div>
                        <div>تكاليف التدفئة/التبريد</div>
                    </div>
                    <div class="comparison-item">
                        <h3>توبشيلد</h3>
                        <div class="value topshield-value" id="topshieldWindowSlice">32%</div>
                        <div>تكاليف التدفئة/التبريد</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <i class="fas fa-calculator"></i>
                    <h2>حاسبة التوفير الشخصية</h2>
                </div>
                <div class="calculator-form">
                    <div>
                        <label for="area">مساحة المنزل (متر مربع):</label>
                        <input type="number" id="area" value="150">
                    </div>
                    <div>
                        <label for="windowType">نوع النوافذ الحالية:</label>
                        <select id="windowType">
                            <option value="single">زجاج مفرد عادي</option>
                            <option value="double_old">زجاج مزدوج قديم</option>
                        </select>
                    </div>
                    <div>
                        <label for="avgBill">متوسط فاتورة الكهرباء الشهرية (ريال - اختياري):</label>
                        <input type="number" id="avgBill" placeholder="مثال: 700">
                    </div>
                    <button id="calculateSavingsBtn">احسب التوفير المتوقع</button>
                </div>
                <div class="savings-result" id="savingsResultDisplay" style="display: none;">
                    <h3>تقديرات التوفير مع توبشيلد:</h3>
                    <p>توفير الطاقة السنوي: <span class="savings-amount" id="energySavingResult"></span> كيلوواط/ساعة</p>
                    <p>توفير مالي سنوي تقريبي: <span class="savings-amount" id="moneySavingResult"></span> ريال</p>
                    <p>تقليل انبعاثات CO₂: <span class="savings-amount" id="co2SavingResult"></span> كجم</p>
                    <p style="font-size:0.9rem; opacity:0.7; margin-top:10px;">*هذه تقديرات أولية وقد تختلف بناءً على عوامل متعددة.</p>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-thermometer-half"></i>
                    <h2>الراحة الحرارية الداخلية</h2>
                </div>
                <div class="chart-container">
                    <p id="comfortScenarioText" style="text-align:center; font-size: 1.1rem; margin-bottom:15px;">سيناريو الصيف:</p>
                    <div class="heat-bar">
                        <div class="marker" id="normalWindowMarker" style="left: 20%;">
                            <div class="marker-label" id="normalWindowLabel">نوافذ عادية: 28°C</div>
                        </div>
                        <div class="marker" style="left: 50%;">
                            <div class="marker-label">مثالي: 22°C</div>
                        </div>
                        <div class="marker" id="topshieldWindowMarker" style="left: 45%;">
                            <div class="marker-label" id="topshieldWindowLabel">توبشيلد: 22°C</div>
                        </div>
                    </div>
                    <div class="info-grid">
                        <div class="info-item">
                            <i class="fas fa-temperature-high"></i>
                            <div>درجة الحرارة الخارجية</div>
                            <div class="value" id="outdoorTemp">38°C</div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-home"></i>
                            <div>الراحة مع نوافذ عادية</div>
                            <div class="value normal-value" id="comfortNormal">28°C</div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-shield-alt"></i>
                            <div>الراحة مع توبشيلد</div>
                            <div class="value topshield-value" id="comfortTopshield">22°C</div>
                        </div>
                        <div class="info-item">
                            <i class="fas fa-leaf"></i>
                            <div>تحسن الراحة</div>
                            <div class="savings" id="comfortImprovement">6°C</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-coins"></i>
                    <h2>توفير التكاليف التراكمي (5 سنوات)</h2>
                </div>
                <div class="chart-container">
                    <canvas id="savingsChart"></canvas>
                </div>
                 <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #ff7b7b;"></div>
                        <span>تكاليف الطاقة (نوافذ عادية)</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: #a8e063;"></div>
                        <span>تكاليف الطاقة (توبشيلد)</span>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="fas fa-sun"></i>
                    <h2>كيف يعمل زجاج توبشيلد الذكي؟</h2>
                </div>
                <div class="glass-structure">
                    <div class="glass-pane">
                        <div class="coating top-coating"></div>
                        <div class="coating bottom-coating"></div>
                        <div class="radiation radiation-1 radiation-blocked"></div>
                        <div class="radiation radiation-2 radiation-transmitted"></div>
                        <div class="radiation radiation-3 radiation-blocked"></div>
                         <div class="radiation-label" style="top: 13%; left: -120px; background: rgba(255,123,123,0.8);">حرارة الشمس (IR)</div>
                        <div class="radiation-label" style="top: 38%; left: -100px; background: rgba(241,196,15,0.8);">ضوء مرئي</div>
                        <div class="radiation-label" style="top: 63%; left: -120px; background: rgba(255,123,123,0.8);">حرارة شمس (IR)</div>
                    </div>
                </div>
                <div class="info-grid" style="grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));"> <div class="info-item">
                        <i class="fas fa-fire-extinguisher"></i> <div>عكس الحرارة (IR)</div>
                        <div class="value topshield-value">~85%</div>
                        <small style="font-size:0.8em; opacity:0.7;">U-value: ~1.6 W/m²K</small>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-eye"></i> <div>نفاذية الضوء (VT)</div>
                        <div class="value" style="color:#e8e8ff">~75%</div>
                        <small style="font-size:0.8em; opacity:0.7;">إضاءة طبيعية ممتازة</small>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-umbrella-beach"></i> <div>حجب الأشعة UV</div>
                        <div class="value topshield-value">~99%</div>
                        <small style="font-size:0.8em; opacity:0.7;">يحمي الأثاث</small>
                    </div>
                     <div class="info-item">
                        <i class="fas fa-solar-panel"></i>
                        <div>كسب حراري (SHGC)</div>
                        <div class="value topshield-value">~0.25</div>
                        <small style="font-size:0.8em; opacity:0.7;">منخفض = حرارة أقل</small>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <i class="fas fa-comments"></i>
                    <h2>ماذا يقول عملاؤنا السعداء؟</h2>
                </div>
                <div id="testimonialsContainer">
                    <div class="testimonial-card">
                        <p class="stars"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i></p>
                        <p class="quote">"منذ تركيب نوافذ توبشيلد، لاحظت فرقاً هائلاً في برودة المنزل خلال صيف الدمام الحار. فاتورة الكهرباء انخفضت بشكل ملحوظ أيضاً! أنصح به بشدة."</p>
                        <p class="author">- عبدالله الغامدي، الدمام</p>
                    </div>
                    <div class="testimonial-card">
                         <p class="stars"><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i></p>
                        <p class="quote">"كنت أعاني من وهج الشمس المزعج في مكتبي، مما يجعل العمل صعباً. نوافذ توبشيلد حلت المشكلة ووفرت جواً مريحاً للعمل مع الحفاظ على الإضاءة الطبيعية."</p>
                        <p class="author">- سارة القحطاني، الخبر</p>
                    </div>
                    </div>
            </div>
        </div>
        
        <section class="cta-section">
            <h2>هل أنت مستعد لتحويل منزلك وتوفير المال؟</h2>
            <p>اتخذ الخطوة الأولى نحو مستقبل أكثر راحة وكفاءة في استهلاك الطاقة. فريق خبرائنا جاهز لمساعدتك.</p>
            <a href="#contact" class="cta-button">اطلب عرض سعر مجاني الآن <i class="fas fa-arrow-circle-left"></i></a>
        </section>

        <div class="footer-note">
            <p>نوافذ <span class="highlight">توبشيلد</span> الذكية: استثمارك الأمثل لراحة تدوم وتوفير حقيقي يصل إلى <span class="highlight" id="footerSavingsPercentage">40%</span> وأكثر!</p>
            <p>نلتزم بتقديم حلول مبتكرة تحقق أعلى معايير الجودة والأداء.</p>
        </div>
    </div>

    <script>
        // بيانات الرسم البياني السنوي
        const months = ['يناير', 'فبراير', 'مارس', 'أبريل', 'مايو', 'يونيو', 'يوليو', 'أغسطس', 'سبتمبر', 'أكتوبر', 'نوفمبر', 'ديسمبر'];
        const normalEnergyData = {
            summer: [780, 750, 720, 800, 950, 1100, 1250, 1200, 1000, 850, 790, 760], // Higher in summer for Dammam
            winter: [650, 620, 600, 580, 550, 520, 500, 530, 560, 590, 630, 660]  // Lower in winter
        };
        const topshieldEnergyData = {
            summer: [550, 530, 510, 580, 680, 780, 880, 850, 720, 610, 560, 540],
            winter: [480, 460, 450, 440, 430, 410, 400, 420, 435, 455, 470, 490]
        };
        let currentSeason = 'summer'; // Default season

        function calculateAnnualSavings(normal, topshield) {
            const totalNormal = normal.reduce((a, b) => a + b, 0);
            const totalTopshield = topshield.reduce((a, b) => a + b, 0);
            const savedKWh = totalNormal - totalTopshield;
            const percentageSavings = ((savedKWh / totalNormal) * 100).toFixed(1);
            document.getElementById('annualSavingsText').innerHTML = `إجمالي التوفير السنوي المقدر: <strong style="font-size:1.3em;">${savedKWh} كيلوواط/ساعة</strong> (حوالي ${percentageSavings}%)`;
            document.getElementById('footerSavingsPercentage').textContent = percentageSavings + '%';

        }
        
        // رسم بياني لتوفير الطاقة السنوي
        const energyCtx = document.getElementById('energyChart').getContext('2d');
        const energyChart = new Chart(energyCtx, {
            type: 'line',
            data: {
                labels: months,
                datasets: [
                    {
                        label: 'نوافذ عادية',
                        data: normalEnergyData[currentSeason],
                        borderColor: '#ff7b7b',
                        backgroundColor: 'rgba(255, 123, 123, 0.15)',
                        borderWidth: 3, // Thinner lines
                        tension: 0.4, // Smoother curves
                        fill: true,
                        pointRadius: 4, // Smaller points
                        pointBackgroundColor: '#ff7b7b'
                    },
                    {
                        label: 'نوافذ توبشيلد',
                        data: topshieldEnergyData[currentSeason],
                        borderColor: '#a8e063',
                        backgroundColor: 'rgba(168, 224, 99, 0.15)',
                        borderWidth: 3,
                        tension: 0.4,
                        fill: true,
                        pointRadius: 4,
                        pointBackgroundColor: '#a8e063'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        mode: 'index',
                        intersect: false,
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed.y !== null) {
                                    label += context.parsed.y + ' ك.و.س';
                                }
                                return label;
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: false,
                        //min: currentSeason === 'summer' ? 400 : 300, // Dynamic min based on season
                        grid: { color: 'rgba(255, 255, 255, 0.1)' },
                        ticks: { color: '#b0e0ff', font: {size: 10} }
                    },
                    x: {
                        grid: { display: false }, // Cleaner look
                        ticks: { color: '#b0e0ff', font: {size: 10} }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
        calculateAnnualSavings(normalEnergyData[currentSeason], topshieldEnergyData[currentSeason]);
        
        // رسم بياني دائري لتوزيع استهلاك الطاقة
        const consumptionCtx = document.getElementById('consumptionChart').getContext('2d');
        const consumptionChart = new Chart(consumptionCtx, {
            type: 'doughnut',
            data: {
                labels: ['التدفئة/التبريد (نوافذ عادية)', 'استخدامات أخرى (نوافذ عادية)', 'التدفئة/التبريد (توبشيلد)', 'استخدامات أخرى (توبشيلد)'],
                datasets: [
                    {
                        label: 'نوافذ عادية',
                        data: [54, 46], // 54% Cooling/Heating, 46% Other
                        backgroundColor: ['#ff7b7b', 'rgba(255, 123, 123, 0.3)'],
                        borderWidth: 0,
                        circumference: 180, // Half circle
                        rotation: 270
                    },
                    {
                        label: 'توبشيلد',
                        data: [32, 68], // 32% Cooling/Heating, 68% Other
                        backgroundColor: ['#a8e063', 'rgba(168, 224, 99, 0.3)'],
                        borderWidth: 0,
                        circumference: 180, // Half circle
                        rotation: 270,
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: { color: '#b0e0ff', padding: 15, font: { size: 11 } }
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.label || '';
                                if (label) { label += ': '; }
                                if (context.parsed !== null) {
                                    label += context.parsed + '%';
                                }
                                return label;
                            }
                        }
                    }
                },
                cutout: '60%', // Adjust cutout
                animation: {
                    animateRotate: true,
                    animateScale: true
                }
            }
        });
        
        // رسم بياني للتوفير المالي
        const savingsCtx = document.getElementById('savingsChart').getContext('2d');
        const savingsChart = new Chart(savingsCtx, {
            type: 'bar',
            data: {
                labels: ['السنة 1', 'السنة 2', 'السنة 3', 'السنة 4', 'السنة 5'],
                datasets: [
                    {
                        label: 'تكاليف الطاقة (نوافذ عادية)',
                        data: [7200, 7450, 7700, 7950, 8200], // Example annual costs in SAR
                        backgroundColor: 'rgba(255, 123, 123, 0.7)',
                        borderColor: '#ff7b7b',
                        borderWidth: 1,
                        borderRadius: 5
                    },
                    {
                        label: 'تكاليف الطاقة (توبشيلد)',
                        data: [4320, 4250, 4180, 4110, 4040], // Assuming ~40% savings initially, then slight decrease
                        backgroundColor: 'rgba(168, 224, 99, 0.7)',
                        borderColor: '#a8e063',
                        borderWidth: 1,
                        borderRadius: 5
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: { color: 'rgba(255, 255, 255, 0.1)' },
                        ticks: { color: '#b0e0ff', callback: function(value) { return value + ' ريال'; }, font: {size:10} }
                    },
                    x: {
                        grid: { display: false },
                        ticks: { color: '#b0e0ff', font: {size:10} }
                    }
                }
            }
        });
        
        // التحكم في الأزرار الموسمية
        const seasonButtons = document.querySelectorAll('.season-btn');
        const outdoorTempEl = document.getElementById('outdoorTemp');
        const comfortNormalEl = document.getElementById('comfortNormal');
        const comfortTopshieldEl = document.getElementById('comfortTopshield');
        const comfortImprovementEl = document.getElementById('comfortImprovement');
        const normalWindowMarker = document.getElementById('normalWindowMarker');
        const normalWindowLabel = document.getElementById('normalWindowLabel');
        const topshieldWindowMarker = document.getElementById('topshieldWindowMarker');
        const comfortScenarioTextEl = document.getElementById('comfortScenarioText');


        seasonButtons.forEach(button => {
            button.addEventListener('click', function() {
                seasonButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                currentSeason = this.getAttribute('data-season');
                updateSeasonalData(currentSeason);
                energyChart.data.datasets[0].data = normalEnergyData[currentSeason];
                energyChart.data.datasets[1].data = topshieldEnergyData[currentSeason];
                //energyChart.options.scales.y.min = currentSeason === 'summer' ? 400 : 300;
                energyChart.update();
                calculateAnnualSavings(normalEnergyData[currentSeason], topshieldEnergyData[currentSeason]);
            });
        });
        
        function updateSeasonalData(season) {
            let outdoorT, normalT, topshieldT, improvementT, normalMarkerPos, topshieldMarkerPos, scenarioText;
            if (season === 'summer') {
                scenarioText = "سيناريو الصيف (الدمام):";
                outdoorT = 38; normalT = 30; topshieldT = 24;
                normalMarkerPos = '25%'; topshieldMarkerPos = '52%';
            } else { // Winter in Dammam is mild
                scenarioText = "سيناريو الشتاء (الدمام):";
                outdoorT = 18; normalT = 16; topshieldT = 21; // Topshield might keep it slightly warmer if desired
                normalMarkerPos = '65%'; topshieldMarkerPos = '48%';
            }
            improvementT = Math.abs(normalT - topshieldT);

            comfortScenarioTextEl.textContent = scenarioText;
            outdoorTempEl.textContent = outdoorT + '°C';
            comfortNormalEl.textContent = normalT + '°C';
            comfortTopshieldEl.textContent = topshieldT + '°C';
            comfortImprovementEl.textContent = improvementT + '°C';
            
            normalWindowMarker.style.left = normalMarkerPos;
            normalWindowLabel.textContent = `نوافذ عادية: ${normalT}°C`;
            topshieldWindowMarker.style.left = topshieldMarkerPos;
            // topshieldWindowLabel.textContent = `توبشيلد: ${topshieldT}°C`; // This is already set correctly in HTML for ideal, let's update the dynamic one
        }
        updateSeasonalData(currentSeason); // Initialize with default season

        // Calculator Logic
        const calculateSavingsBtn = document.getElementById('calculateSavingsBtn');
        const areaInput = document.getElementById('area');
        const windowTypeInput = document.getElementById('windowType');
        const avgBillInput = document.getElementById('avgBill');
        const savingsResultDisplay = document.getElementById('savingsResultDisplay');
        const energySavingResultEl = document.getElementById('energySavingResult');
        const moneySavingResultEl = document.getElementById('moneySavingResult');
        const co2SavingResultEl = document.getElementById('co2SavingResult');

        calculateSavingsBtn.addEventListener('click', function() {
            const area = parseFloat(areaInput.value) || 150; // Default area if input is invalid
            const windowType = windowTypeInput.value;
            const avgBill = parseFloat(avgBillInput.value) || 0;

            // Simplified saving factors (these should be more complex and data-driven in a real app)
            let energySavingFactorPerM2 = 50; // kWh saved per m2 per year with TopShield vs single pane
            if (windowType === 'double_old') {
                energySavingFactorPerM2 = 30; // Less savings if upgrading from old double pane
            }

            const estimatedEnergySaving = area * energySavingFactorPerM2;
            
            // Assume an average electricity price in SAR per kWh (e.g., 0.18 SAR for residential)
            // This is a major simplification. Real tariffs are tiered.
            const electricityPrice = 0.18; 
            let estimatedMoneySaving = estimatedEnergySaving * electricityPrice;

            if (avgBill > 0) {
                // A very rough estimate: assume 40% of bill is for cooling/heating, and TopShield saves 30-50% of THAT.
                // This provides an alternative money saving estimate if bill is provided.
                const coolingHeatingPortion = avgBill * 12 * 0.40; // Annual cooling/heating cost
                const savingFromBill = coolingHeatingPortion * 0.35; // Assume 35% saving on that portion
                estimatedMoneySaving = Math.max(estimatedMoneySaving, savingFromBill); // Take the more optimistic or relevant
            }
            
            // CO2 savings: approx. 0.5 - 0.7 kg CO2 per kWh depending on energy source. Using 0.6 kg/kWh
            const co2Factor = 0.6;
            const estimatedCo2Saving = estimatedEnergySaving * co2Factor;

            energySavingResultEl.textContent = estimatedEnergySaving.toFixed(0);
            moneySavingResultEl.textContent = estimatedMoneySaving.toFixed(0);
            co2SavingResultEl.textContent = estimatedCo2Saving.toFixed(0);
            savingsResultDisplay.style.display = 'block';
        });
        
    </script>
</body>
</html>